<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Browser speech recognition</title>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <header>
      <h1>Browser speech recognition</h1>
    </header>
    <main>
      <section class="button_section">
          <button id="button">Start listening</button>
      <!-- è¿½è¨˜1ã€€ã“ã“ã‹ã‚‰ -->
          <button id="button2">to Log</button>
          <button id="button3">memo about Log</button>
      </section>
      <section class="result_section">
      <!-- è¿½è¨˜1ã€€ã“ã“ã¾ã§ -->
        <div id="result"></div><span id="counter_section"></span>
        <!-- è¿½è¨˜2ã€€ã“ã“ã‹ã‚‰ -->
        <div id="result2"></div>
        <div id="result3"></div><span id="count"></span>
      </section>
      <!-- è¿½è¨˜2çµ‚ã€€ã“ã“ã¾ã§ -->
      <p id="message" hidden aria-hidden="true">
        Your browser doesn't support Speech Recognition. Sorry.
      </p>
    </main>
    <footer>
      <p>Built with ğŸ™ by <a href="https://twitter.com/philnash">philnash</a></p>
    </footer>
    <script>
        window.addEventListener("DOMContentLoaded", () => {
            const button = document.getElementById("button");
            const result = document.getElementById("result");
            const main = document.getElementsByTagName("main")[0];
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition
            if (typeof SpeechRecognition === "undefined") {
                button.remove();
                const message = document.getElementById("message");
                message.removeAttribute("hidden");
                message.setAttribute("aria-hidden", "false");
              } else {
                  let listening = false;
                  const recognition = new SpeechRecognition();
                  const start = () => {
                      recognition.start();
                      button.textContent = "Stop listening";
                      main.classList.add("speaking");
                  };
                  const stop = () => {
                      recognition.stop();
                      button.textContent = "Start listening";
                      main.classList.remove("speaking");
                  };
                  const onResult = event => {
                      result.innerHTML = "";
                      for (const res of event.results) {
                          const text = document.createTextNode(res[0].transcript);
                          const p = document.createElement("p");
                          if (res.isFinal) {
                              p.classList.add("final");
                          }
                          p.appendChild(text);
                          result.appendChild(p);
                      }
                  };
                  recognition.continuous = true;
                  recognition.interimResults = true;
                  recognition.addEventListener("result", onResult);
                  button.addEventListener("click", () => {
                      listening ? stop() : start();
                      listening = !listening;
                      //è¿½è¨˜ start
                      // const counter_section = document.getElementById("counter_section");
                      // counter_section.innerHTML=listening;
                      const count = document.getElementById("count");
                      count.innerHTML="0";
                      //è¿½è¨˜ end
                  });
              }
        });
        //è¿½è¨˜3ã€€start
        // 1.ãƒ­ã‚°ã‚’ä¸€æ™‚çš„ã«è¨˜éŒ²ã—ã¦ãŠãã€Œa moment of logã€ã®ã‚³ãƒ¼ãƒ‰
        const button2 = document.getElementById("button2");
        button2.addEventListener("click",() => {
        const log_tag = document.getElementById("result");
        const result2 = document.getElementById("result2");
        result2.innerHTML = log_tag.innerHTML;
        });
        // 2.1ã§ä¸€æ™‚çš„ã«è¨˜éŒ²ã—ãŸãƒ­ã‚°ã‚’ã€è‡ªåˆ†ã®ãƒ¡ãƒ¢ã«ç§»å‹•ã™ã‚‹æ©Ÿèƒ½ã€Œmy loggingã€
        const button3 = document.getElementById("button3");
        let i = 0;
        button3.addEventListener("click",() => {
        const memo_tag = document.getElementById("result2");
        const result3 = document.getElementById("result3");
        const count = document.getElementById("count");
        i = parseInt(count.innerHTML, 10);
        if(i===0){
          // button3ã®ãƒ¡ãƒ¢ã‚’1è¡Œã«ã¾ã¨ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ start
          const p = document.createElement("p");
          p.innerHTML = memo_tag.innerHTML;
          result3.appendChild(p);
          // button3ã®ãƒ¡ãƒ¢ã‚’1è¡Œã«ã¾ã¨ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ end
        }
          // id countã€€ã®HTML(iã®æ–‡å­—åˆ—ã¨ãªã£ãŸæ•°å­—)ã‚’èª­ã¿å–ã£ã¦ã€10é€²æ•°ã®æ•°å€¤ã«æˆ»ã™æ“ä½œ start
          i = parseInt(count.innerHTML, 10);
          i += 1;
          // id countã€€ã®HTML(iã®æ–‡å­—åˆ—ã¨ãªã£ãŸæ•°å­—)ã‚’èª­ã¿å–ã£ã¦ã€10é€²æ•°ã®æ•°å€¤ã«æˆ»ã™æ“ä½œã€€end
          count.innerHTML=i;
      });
        //è¿½è¨˜3 çµ‚
    </script>
    <!-- https://www.twilio.com/blog/speech-recognition-browser-web-speech-api-jp

    Web Speech APIã‚’åˆ©ç”¨ã—ãƒ–ãƒ©ã‚¦ã‚¶ã§éŸ³å£°ã‚’èªè­˜ã™ã‚‹æ–¹æ³• -->

    <!-- èª²é¡Œã®èµ·å‹•æ–¹æ³•ãªã©ã€ã‚ã‹ã‚‰ãªã„ã“ã¨ã”ã–ã„ã¾ã—ãŸã‚‰ãƒ¡ãƒ¼ãƒ«ã§ã®ã‚„ã‚Šã¨ã‚Šã‚’ã‚ˆã‚ã—ããŠé¡˜ã„è‡´ã—ã¾ã™ã€‚è—¤ç”° -->
  </body>
</html>
